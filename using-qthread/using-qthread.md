---
date: 2016-02-20
categories:
  - it
  - programming
tags:
  - Qt
  - C++
author: Anton Sergienko
author-email: anton.b.sergienko@gmail.com
license: CC BY 4.0
license-url: https://github.com/Harrix/harrix.dev/blob/main/LICENSE.md
permalink-source: https://github.com/Harrix/harrix.dev-articles-2016/blob/main/using-qthread/using-qthread.md
permalink: https://harrix.dev/ru/articles/2016/using-qthread/
lang: ru
---

# –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è QThread –≤ Qt

![Featured image](featured-image.svg)

–í —Å—Ç–∞—Ç—å–µ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∏ –±–æ–ª–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Å–ø–æ—Å–æ–±–∞—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑–º–∞ –ø–æ—Ç–æ–∫–æ–≤ —á–µ—Ä–µ–∑ QThread –≤ Qt.

<details>
<summary>üìñ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</summary>

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±](#–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π-—Å–ø–æ—Å–æ–±)
- [–ë–æ–ª–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±](#–±–æ–ª–µ–µ-–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π-—Å–ø–æ—Å–æ–±)

</details>

–ü–æ—Ç–æ–∫–∏ ‚Äî —É–¥–æ–±–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º –µ—Å—Ç—å –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –Ω–µ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã, —á—Ç–æ–±—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç–æ—Ä–º–æ–∑–∏–ª. –†–∞–∑—É–º–µ–µ—Ç—Å—è, —á—Ç–æ –µ—Å—Ç—å –µ—â–µ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —Å–∏—Ç—É–∞—Ü–∏–π, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –Ω–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

## –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø–æ—Å–æ–± ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ—Ç–æ–º–∫–∞ –æ—Ç –∫–ª–∞—Å—Å–∞ `QThread` –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Ç–æ–¥ `run`. –ù–æ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –¥–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–¥–µ–æ–ª–æ–≥–∏–∏ –û–û–ü –∏ –º–Ω–æ–≥–∏–µ –µ–≥–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç.

–°–æ–∑–¥–∞–¥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ –¥–æ–ª–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –Ω–∞ 1 –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É, –∞ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —Å–ø–∏—Ç. –ü—Ä–∏ —ç—Ç–æ–º –≤ `textEdit` –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å—á–µ—Ç—á–∏–∫–∞:

```cpp
for(int i = 0; i <= 100; i++) {
  Sleep(1000);
}
```

–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—É–¥–µ—Ç —Ç–∞–∫–∏–º:

![–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/program_01.png)

_–†–∏—Å—É–Ω–æ–∫ 1 ‚Äî –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã_

–ï—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞, —Ç–æ –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø—Ä–æ—Å—Ç–æ –∑–∞–≤–∏—Å–Ω–µ—Ç –∏ –Ω–µ –±—É–¥–µ—Ç –æ—Ç–∫–ª–∏–∫–∞—Ç—å—Å—è –Ω–∞ –Ω–∞—à–∏ –¥–µ–π—Å—Ç–≤–∏—è.

–ò—Ç–∞–∫, —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å MyThread.

<details>
<summary>–û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ –≤ Qt</summary>

![–í—ã–±–æ—Ä –ø—É–Ω–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞](img/new-class_01.png)

_–†–∏—Å—É–Ω–æ–∫ 2 ‚Äî –í—ã–±–æ—Ä –ø—É–Ω–∫—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞_

![–í—ã–±–æ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞](img/new-class_02.png)

_–†–∏—Å—É–Ω–æ–∫ 3 ‚Äî –í—ã–±–æ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞_

![–í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞](img/new-class_03.png)

_–†–∏—Å—É–Ω–æ–∫ 4 ‚Äî –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞_

![–§–∞–π–ª—ã –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞](img/new-class_04.png)

_–†–∏—Å—É–Ω–æ–∫ 5 ‚Äî –§–∞–π–ª—ã –Ω–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞_

</details>

`mythread.cpp`:

```cpp
#include "mythread.h"
#include <QDebug>
#include <windows.h>

MyThread::MyThread(QString s) : name(s)
{
}

void MyThread::run()
{
  for(int i = 0; i <= 100; i++) {
    emit send(i);
    Sleep(1000);
  }
}
```

`mythread.h`:

```cpp
#ifndef MYTHREAD_H
#define MYTHREAD_H

#include <QThread>
#include <QString>

class MyThread : public QThread
{
Q_OBJECT
public:
explicit MyThread(QString s);

  void run();

signals:
  void send(int);

private:
  QString name;
};

#endif // MYTHREAD_H
```

–ß—Ç–æ —É –Ω–∞—Å —Ç—É—Ç –µ—Å—Ç—å?

- –ö–ª–∞—Å—Å –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç –∫–ª–∞—Å—Å–∞ `QThread`, –∞ —Ç–∞–∫–∂–µ –æ–±–ª–∞–¥–∞–µ—Ç –º–∞–∫—Ä–æ—Å–æ–º `Q_OBJECT`. –ë–µ–∑ –Ω–µ–≥–æ –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã –∏ —Å–ª–æ—Ç—ã.

- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è –ø–æ—Ç–æ–∫–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤ –ø–æ—Ç–æ–∫ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω—É–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–æ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞.

- –û—Å–Ω–æ–≤–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –º–µ—Ç–æ–¥–µ `run()`.

- –£ –Ω–∞—Å –µ—Å—Ç—å —Å–∏–≥–Ω–∞–ª `void send(int)`, –∫–æ—Ç–æ—Ä—ã–π –∏–∑ –ø–æ—Ç–æ–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—á–µ—Ç—á–∏–∫–∞ `i` –≤ –º–µ—Ç–æ–¥–µ `run()`:

```cpp
emit send(i);
```

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–∏–≥–Ω–∞–ª –∏–∑ –ø–æ—Ç–æ–∫–∞ –ø–æ–ª—É—á–∞—Ç—å –≤ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ, –Ω–∞–º –Ω—É–∂–µ–Ω —Å–ª–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–∞–Ω–Ω—ã–π —Å–∏–≥–Ω–∞–ª –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å. –ü–æ—ç—Ç–æ–º—É –≤ `mainwindow.cpp` –ø—Ä–æ–ø–∏—à–µ–º —Å–ª–æ—Ç:

```cpp
void MainWindow::update (int i)
{
  ui->textEdit->insertPlainText(QString::number(i));
}
```

–ê –≤ `mainwindow.h` –æ–±—ä—è–≤–∏–º –µ–≥–æ:

```cpp
void update (int i);
```

![–ú–µ—Ç–æ–¥ update](img/header_01.png)

_–†–∏—Å—É–Ω–æ–∫ 6 ‚Äî –ú–µ—Ç–æ–¥ update_

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤ `mainwindow.cpp` –ø–æ–¥–∫–ª—é—á–∏—Ç—å include:

```cpp
#include "mythread.h"
```

–¢–µ–ø–µ—Ä—å –≤ —Å–ª–æ—Ç–µ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–≥–æ —Å–ª–æ—Ç–∞, —Å–æ–µ–¥–∏–Ω–∏—Ç—å —Å–ª–æ—Ç `update` –∏ —Å–∏–≥–Ω–∞–ª `send`, –∞ –ø–æ—Ç–æ–º —É–∂–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞—à –ø–æ—Ç–æ–∫:

```cpp
void MainWindow::on_pushButton_clicked()
{
  MyThread *thread= new MyThread("A");

  connect(thread, SIGNAL(send(int)), this, SLOT(update(int)));

  thread->start();
}
```

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞:

![–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/program_02.png)

_–†–∏—Å—É–Ω–æ–∫ 7 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã_

–î–æ–ø—É—Å—Ç–∏–º, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫, –Ω–æ –Ω–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∫–æ–ø–∏–∏. –¢–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª –≤ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ, –∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π –µ–≥–æ —Å–ª–æ—Ç –≤ –Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ, —Ç–æ –µ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –Ω–∞–æ–±–æ—Ä–æ—Ç, —á–µ–º –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ.

–í –ø—Ä–∏–º–µ—Ä–µ –Ω–∏–∂–µ –º—ã –¥–æ–±–∞–≤–∏–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `int globalVar` –≤ –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—É—é –∏ –ø–æ–º–µ–Ω—è–µ–º –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª –±—É–¥–µ–º —Å–ª–æ—Ç–æ–º `receiveGlobalVar(int globalVar)`.

–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

`mythread.cpp`:

```cpp
#include "mythread.h"
#include <QDebug>
#include <windows.h>

MyThread::MyThread(QString s) : name(s)
{
}

void MyThread::run()
{
  for(int i = 0; i <= 100; i++) {
    emit send(i);
    Sleep(1000);
  }
}

void MyThread::receiveGlobalVar(int globalVar)
{
  qDebug() << "globalVar = " << globalVar;
  this->globalVar = globalVar;
}
```

`mythread.h`:

```cpp
#ifndef MYTHREAD_H
#define MYTHREAD_H

#include <QThread>
#include <QString>

class MyThread : public QThread
{
Q_OBJECT
public:
  explicit MyThread(QString s);

void run();

public slots:
  void receiveGlobalVar (int i);

signals:
  void send(int);

private:
  QString name;

  int globalVar;
};

#endif // MYTHREAD_H
```

–ò –≤ `mainwindow.h` –¥–æ–±–∞–≤–∏–º —Å–∏–≥–Ω–∞–ª:

```cpp
signals:
  void sendGlobalVar(int);
```

![–°–∏–≥–Ω–∞–ª sendGlobalVar](img/header_02.png)

_–†–∏—Å—É–Ω–æ–∫ 8 ‚Äî –°–∏–≥–Ω–∞–ª sendGlobalVar_

–°–æ–µ–¥–∏–Ω—è–µ–º —Å–ª–æ—Ç –∏ —Å–∏–≥–Ω–∞–ª (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∫—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å —Å–∏–≥–Ω–∞–ª–∞, –∞ –∫—Ç–æ –ø–æ–ª—É—á–∞—Ç–µ–ª—å), –∞ –ø–æ—Ç–æ–º –º–æ–∂–µ–º —Å–∏–≥–Ω–∞–ª –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å:

```cpp
connect(this, SIGNAL(sendGlobalVar(int)), thread, SLOT(receiveGlobalVar(int)));
```

```cpp
emit sendGlobalVar(7);
```

–í–æ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–¥ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É:

```cpp
void MainWindow::on_pushButton_clicked()
{
  MyThread *thread= new MyThread("A");

  connect(thread, SIGNAL(send(int)), this, SLOT(update(int)));
  connect(this, SIGNAL(sendGlobalVar(int)), thread, SLOT(receiveGlobalVar(int)));

  emit sendGlobalVar(7);

  thread->start();
}
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –º—ã —É–≤–∏–¥–∏–º, —á—Ç–æ —Å–∏–≥–Ω–∞–ª –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ:

![–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/program_03.png)

_–†–∏—Å—É–Ω–æ–∫ 9 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã_

## –ë–æ–ª–µ–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±

–ü–æ –∏–¥–µ–∏ –∫–ª–∞—Å—Å `QThread` –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–æ–ø–∏—Å—ã–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –Ω–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ. –ï–≥–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–º, —á—Ç–æ –≤ –Ω–µ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

–ö —Ç–æ–º—É –∂–µ, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ, –Ω–∞–º –ø—Ä–∏—à–ª–æ—Å—å –¥–æ–±–∞–≤–ª—è—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ –∫–ª–∞—Å—Å (`globalVar`), —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–ª—É—á–∏—Ç—å –∫ –Ω–∏–º –¥–æ—Å—Ç—É–ø –∏–∑ —Ä–∞–∑–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ —Å–ª–æ—Ç–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞. –≠—Ç–æ –≤—Å—ë –Ω–µ –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ –∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥—É—Ö—É –û–û–ü.

–ö—É–¥–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ –±—É–¥–µ—Ç –ø—Ä–æ–ø–∏—Å–∞—Ç—å –∫–ª–∞—Å—Å —Å –Ω—É–∂–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º, —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä –∏ –∑–∞–ø–∏—Ö–∞—Ç—å –µ–≥–æ –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ `QThread`. –ß—Ç–æ –º—ã –∏ —Å–¥–µ–ª–∞–µ–º.

–í–Ω–∞—á–∞–ª–µ —Å–æ–∑–¥–∞–¥–∏–º –∫–ª–∞—Å—Å `MyClass`.

`myclass.cpp`:

```cpp
#include "myclass.h"
#include <QDebug>
#include <windows.h>

MyClass::MyClass(QString s) : name(s)
{

}

void MyClass::doWork()
{
  for(int i = 0; i <= 100; i++) {
    emit send(i);
    Sleep(1000);
  }
}
```

`myclass.h`:

```cpp
#ifndef MYCLASS_H
#define MYCLASS_H

#include <QObject>
#include <QString>

class MyClass:public QObject
{
Q_OBJECT
public:
  MyClass(QString name);

public slots:
  void doWork();

signals:
  void send(int);

private:
  QString name;
};

#endif // MYCLASS_H
```

–ó–¥–µ—Å—å —Ç–µ–ø–µ—Ä—å –Ω–∞—à –∫–ª–∞—Å—Å –±—É–¥–µ—Ç –æ–±–ª–∞–¥–∞—Ç—å –º–∞–∫—Ä–æ—Å–æ–º `Q_OBJECT`, –∞ —Ç–∞–∫–∂–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ –ø—Ä–∏–µ–º–æ–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –µ–º—É —Å–∏–≥–Ω–∞–ª–æ–≤.

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±—É–¥–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –≤ –º–µ—Ç–æ–¥–µ `doWork()`, –≥–¥–µ —Ç–∞–∫–∂–µ –∫–∞–∫ –∏ ¬´–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º¬ª –º–µ—Ç–æ–¥–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–∏–≥–Ω–∞–ª `send()`.

–í `mainwindow.cpp` –º—ã —É–∂–µ –Ω–µ –±—É–¥–µ–º –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å —Å–ª–æ—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–∞ `update`, —Ç–∞–∫ –∫–∞–∫ —É–∂–µ –æ–Ω –Ω–∞–ø–∏—Å–∞–Ω –¥–ª—è ¬´–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ¬ª —Å–ø–æ—Å–æ–±–∞.

–¢–∞–∫ —á—Ç–æ –ø–æ–¥–∫–ª—é—á–∏–º —Ç–æ–ª—å–∫–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π include:

```cpp
#include "myclass.h"
```

–ò –≤ —Å–ª–æ—Ç–µ –Ω–∞–∂–∞—Ç–∏—è –≤—Ç–æ—Ä–æ–π –∫–Ω–æ–ø–∫–∏ –ø—Ä–æ–ø–∏—à–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

```cpp
QThread *thread= new QThread;
MyClass *my = new MyClass("B");

my->moveToThread(thread);

connect(my, SIGNAL(send(int)), this, SLOT(update(int)));
connect(thread, SIGNAL(started()), my, SLOT(doWork()));

thread->start();
```

–í–Ω–∞—á–∞–ª–µ –º—ã —Å–æ–∑–¥–∞–ª–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ `QThread` –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–°–æ–∑–¥–∞–ª–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–≥–æ –∫–ª–∞—Å—Å–∞.

–ü–æ—Ç–æ–º –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—à–µ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫.

–°–æ–µ–¥–∏–Ω–∏–ª–∏ —Å–∏–≥–Ω–∞–ª –∏–∑ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞ `MyClass` –∏ –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–≥–æ —Å–ª–æ—Ç–∞ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.

–°–æ–µ–¥–∏–Ω–∏–ª–∏ —Å–∏–≥–Ω–∞–ª **–Ω–æ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞** –æ —Å—Ç–∞—Ä—Ç–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Ç–æ–∫–∞ —Å –º–µ—Ç–æ–¥–æ–º `doWork()` –∫–ª–∞—Å—Å–∞ `MyClass`, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø–æ—Ç–æ–∫–∞.

–ò –ø–æ—Ç–æ–º –ø–æ—Ç–æ–∫ –∑–∞–ø—É—Å–∫–∞–µ–º:

![–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/program_04.png)

_–†–∏—Å—É–Ω–æ–∫ 10 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã_

–ï—Å–ª–∏ –∂–µ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª –≤ –ø–æ—Ç–æ–∫ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ, —Ç–æ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –≤ –∫–ª–∞—Å—Å–µ MyClass —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–ª–æ—Ç –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Å–∏–≥–Ω–∞–ª–∞ `receiveGlobalVar()`:

`myclass.cpp`:

```cpp
#include "myclass.h"
#include <QDebug>
#include <windows.h>

MyClass::MyClass(QString s) : name(s)
{

}

void MyClass::doWork()
{
  for(int i = 0; i <= 100; i++) {
    emit send(i);
    Sleep(1000);
  }
}

void MyClass::receiveGlobalVar(int globalVar)
{
  qDebug() << "globalVar = " << globalVar;
  this->globalVar = globalVar;
}
```

`myclass.h`:

```cpp
#ifndef MYCLASS_H
#define MYCLASS_H

#include <QObject>
#include <QString>

class MyClass:public QObject
{
Q_OBJECT
public:
  MyClass(QString name);

public slots:
  void doWork();
  void receiveGlobalVar (int i);

signals:
  void send(int);

private:
  QString name;
  int globalVar;
};

#endif // MYCLASS_H
```

`on_pushButton_2_clicked()`:

```cpp
QThread *thread= new QThread;
MyClass *my = new MyClass("B");

my->moveToThread(thread);

connect(my, SIGNAL(send(int)), this, SLOT(update(int)));
connect(thread, SIGNAL(started()), my, SLOT(doWork()));
connect(this, SIGNAL(sendGlobalVar(int)), my, SLOT(receiveGlobalVar(int)), Qt::DirectConnection);

emit sendGlobalVar(7);

thread->start();

emit sendGlobalVar(7);
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å —Å–≤—è–∑—ã–≤–∞—Ç—å —Å–ª–æ—Ç –∏ —Å–∏–≥–Ω–∞–ª –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `Qt::DirectConnection`:

![–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/program_05.png)

_–†–∏—Å—É–Ω–æ–∫ 11 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã_
