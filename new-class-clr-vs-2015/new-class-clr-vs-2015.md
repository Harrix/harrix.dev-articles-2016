---
date: 2016-09-11
categories: [it, programming]
tags: [C++, Visual Studio, –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏, XML]
author: Anton Sergienko
author-email: anton.b.sergienko@gmail.com
license: CC BY 4.0
license-url: https://github.com/Harrix/harrix.dev/blob/main/LICENSE.md
permalink-source: https://github.com/Harrix/harrix.dev-articles-2016/blob/main/new-class-clr-vs-2015/new-class-clr-vs-2015.md
permalink: https://harrix.dev/ru/articles/2016/new-class-clr-vs-2015/
lang: ru
---

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞ –≤ CLR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤ Visual Studio 2015 –Ω–∞ C++/CLI

![Featured image](featured-image.svg)

–£—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª —Å —Ñ–æ—Ä–º–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è CLR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤ Visual Studio 2015 –Ω–∞ C++/CLI.

## –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–ù–∞–¥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –∏–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é. –ö–ª–∞—Å—Å –ø–æ–ª—É—á–∞–µ—Ç –∏–∑ –∫–Ω–æ–ø–∫–∏ –∏–º—è —Ñ–∞–π–ª–∞, –∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏.

## –ë–æ–ª–≤–∞–Ω–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ò—Ç–∞–∫, —Å–æ–∑–¥–∞–π—Ç–µ –ø—É—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ CLR —Å —Ñ–æ—Ä–º–æ–π. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ [—Å—Ç–∞—Ç—å–µ](https://github.com/Harrix/harrix.dev-articles-2016/blob/main/add-2-num-vs-2015-clr/add-2-num-vs-2015-clr.md) | [ü°•](https://harrix.dev/ru/articles/2016/add-2-num-vs-2015-clr/) –¥–æ–π–¥—è –≤ –Ω–µ–π –¥–æ –ø—É–Ω–∫—Ç–∞ ¬´–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è¬ª.

## –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º–º—ã

–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –Ω–∞ —Ñ–æ—Ä–º—É –∫–Ω–æ–ø–∫—É –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ:

![–ö–Ω–æ–ø–∫–∞ –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ](img/interface_01.png)

_–†–∏—Å—É–Ω–æ–∫ 1 ‚Äî –ö–Ω–æ–ø–∫–∞ –∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ_

–ê —Ç–∞–∫–∂–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞:

![–î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞](img/interface_02.png)

_–†–∏—Å—É–Ω–æ–∫ 2 ‚Äî –î–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è —Ñ–∞–π–ª–∞_

## –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Å–∞

–ü—Ä–∞–≤—ã–π –∫–ª–∏–∫ –ø–æ –ø—Ä–æ–µ–∫—Ç—É, –∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç:

![–í—ã–∑–æ–≤ –∫–æ–º–∞–Ω–¥—ã ¬´–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç¬ª](img/new-class_01.png)

_–†–∏—Å—É–Ω–æ–∫ 3 ‚Äî –í—ã–∑–æ–≤ –∫–æ–º–∞–Ω–¥—ã ¬´–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç¬ª_

–°–æ–∑–¥–∞–µ–º `ExampleClass.h`:

![–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞](img/new-class_02.png)

_–†–∏—Å—É–Ω–æ–∫ 4 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞_

–ò –≤ –Ω–æ–≤–æ–º —Ñ–∞–π–ª–µ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–∞–∫–æ–π –∫–æ–¥:

```cpp
using namespace System;
using namespace System::IO;
using namespace System::Xml;

ref class ExampleClass {
public:
  ExampleClass();
  ExampleClass(String^ fileName);
  void setFileName(String^ fileName);
  String^ getFileExtension();
private:
  String^ fileName;
};
ExampleClass::ExampleClass() {
  fileName = "1.txt";
}
ExampleClass::ExampleClass(String^ fileName) {
  this->fileName = fileName;
}
void ExampleClass::setFileName(String^ fileName) {
  this->fileName = fileName;
}
String^ ExampleClass::getFileExtension() {
  int i = fileName->LastIndexOf(".");
  String^ Ext = fileName->Substring(i);
  return Ext;
}
```

![–ö–æ–¥ –∫–ª–∞—Å—Å–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ](img/new-class_03.png)

_–†–∏—Å—É–Ω–æ–∫ 5 ‚Äî –ö–æ–¥ –∫–ª–∞—Å—Å–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ_

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ—Ç —Ñ–∞–∫—Ç, —á—Ç–æ –Ω–∞–º –ø–µ—Ä–µ–¥ —Å–ª–æ–≤–æ–º `class` –Ω—É–∂–Ω–æ –µ—â–µ –Ω–∞–ø–∏—Å–∞—Ç—å `ref`, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø `String^`.

–¢–∞–∫–∂–µ —è –ø–æ–¥–∫–ª—é—á–∏–ª `System::IO`, `System::Xml`. –ü—Ä–æ—Å—Ç–æ –¥–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–µ–º–∏, –∫–æ–º—É —ç—Ç–∏ –¥–≤–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏–º–µ–Ω –±—É–¥—É—Ç –Ω—É–∂–Ω—ã. –ù–æ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Ö —É–¥–∞–ª–∏—Ç—å.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞

–ü–µ—Ä–µ–π–¥–µ–º –≤ —Ñ–∞–π–ª `MyForm.h`:

![–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ñ–æ—Ä–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](img/use-class_01.png)

_–†–∏—Å—É–Ω–æ–∫ 6 ‚Äî –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ñ–æ—Ä–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è_

–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ:

![–î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ](img/use-class_02.png)

_–†–∏—Å—É–Ω–æ–∫ 7 ‚Äî –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ_

–¢–∞–º –ø–∏—à–µ–º –∫–æ–¥:

```cpp
if (openFileDialog1->ShowDialog() == System::Windows::Forms::DialogResult::OK)
{
  String^ fileName = openFileDialog1->FileName;
  ExampleClass a(fileName);

  String^ Ext = a.getFileExtension();
  textBox1->Text = Ext;
}
```

![–ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞ –∫–Ω–æ–ø–∫–∏](img/use-class_03.png)

_–†–∏—Å—É–Ω–æ–∫ 8 ‚Äî –ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–ª–∏–∫–∞ –∫–Ω–æ–ø–∫–∏_

–ù–µ –∑–∞–±—ã–≤–∞–µ–º –≤–≤–µ—Ä—Ö—É —Ñ–∞–π–ª–∞ `MyForm.h` –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–∞—à —Ñ–∞–π–ª –∫–ª–∞—Å—Å–∞:

```cpp
#include "ExampleClass.h"
```

![–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∫–ª–∞—Å—Å–∞](img/use-class_04.png)

_–†–∏—Å—É–Ω–æ–∫ 9 ‚Äî –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∫–ª–∞—Å—Å–∞_

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã

–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É:

![–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](img/run.png)

_–†–∏—Å—É–Ω–æ–∫ 10 ‚Äî –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è_

–ù–∞–∂–∏–º–∞–µ–º –Ω–∞ –∫–Ω–æ–ø–∫—É:

![–ö–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É](img/result_01.png)

_–†–∏—Å—É–Ω–æ–∫ 11 ‚Äî –ö–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É_

–í—ã–±–∏—Ä–∞–µ–º —Ñ–∞–π–ª:

![–í—ã–±–æ—Ä —Ñ–∞–π–ª–∞](img/result_02.png)

_–†–∏—Å—É–Ω–æ–∫ 12 ‚Äî –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞_

–í —Ç–µ–∫—Å—Ç–æ–≤–æ–º –ø–æ–ª–µ –≤–∏–¥–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:

![–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/result_03.png)

_–†–∏—Å—É–Ω–æ–∫ 13 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã_
